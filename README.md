# Pyth Network Price 

## Overview

TypeScript implementation for decoding, filtering, and re-encoding Pyth Network price feed data for gas-optimized blockchain transactions.



## Architecture

### Data Flow

1. **Fetch** → Hermes API retrieves AccumulatorUpdateData
2. **Decode** → Parse binary format (PNAU header + VAA + price feeds)
3. **Filter** → Select subset of price feeds
4. **Re-encode** → Reconstruct optimized payload
5. **Validate** → Ensure Pyth contract compatibility

### Price Feed Message Format (85 bytes)

```
[1B] Message Type (0x00)
[32B] Feed ID
[8B] Price (signed int64 BE)
[8B] Confidence (uint64 BE)
[4B] Exponent (int32 BE)
[8B] Publish Time (uint64 BE)
[8B] Previous Publish Time (uint64 BE)
[8B] EMA Price (signed int64 BE)
[8B] EMA Confidence (uint64 BE)
```

### Key Functions

- `decodeAccumulatorUpdateData()` - Parses binary Pyth format
- `parsePriceFeedMessage()` - Extracts individual price data
- `encodeAccumulatorUpdateData()` - Reconstructs filtered payload
- `encodePriceFeedMessage()` - Converts struct to binary





## Tech Stack

- TypeScript + Node.js
- @pythnetwork/hermes-client
- Binary data manipulation (Buffer)



## Output 

``` 
Original calldata length: 15046 characters
Total price feeds found: 20
VAA size: 952 bytes

Selected assets:
[
  'bade5c63f281d36a13dbb64ed0ae1c532a434b6771b11885f396a41f56cc3bd0',
  'f253cf87dc7d5ed5aa14cba5a6e79aee8bcfaef885a0e1b807035a0bbecc36fa',
  '2817d7bfe5c64b8ea956e9a26f573ef64e72e4d7891f2d6af9bcc93f7aff9a97',
  '42bfb26778f3504a9f359a92c731f77d0c24aed9b7745276e3ad0c2d840b74c2',
  'b04edaa5eba1fb048c18b727466681894f0ab21dd89643432af0277162dedb6d'
]
Re-encoded calldata successfully
Original size: 15046 characters
Filtered size: 2808 characters
calldata param for updatePriceFeeds() function: 
 "0x504e41550100000003b801000000040d005aa5bfa3c7c72e38ed9db9cd0d4f0125b5e584df68751156450bffd7dc23ba0f1460f4be38b5de5e76606e6c876d6e7f15dc51ad8837dcb3a2373dafce0cef7300028ce2be4989930eeddb06ac38e687b5d1e74589d03806da5d76b61d8eb0e7772b175f3b01caa3bcdfa7f29b465a9ca9c2cb757122e73c5f2f71933a19da20488b010345f616413b3a87ee9f830bf2d99d3333db43f27be0969e6f1c5718c7fef39ce13b8cd0ed5a4c9b607ef4c67573aa270fedc4ec92106856d328a5e46c4685156e000491bd45265b3fb3d53333fc46e173fb104e7ac982220bbbcb17f6b6b26041261b25f3e353bd4dfa5677fbc5a28a76cce77faac6cf25324126e2e9c218ce529b8600067a3a500f7ced9770bc5ce5db70e3d5e7de0b6e7616471d0c5800d39c67b41ea50d66e3a6f3686a2c384055f4bc6a0d47a9758f90a401959e7ede5bb8b5a33393000a60a5bd64db78f555fb439003400faa249e48292b1c6bde7fd193078b900b0bb40fc3a8bdf7849d37672e64f3b24ba691ec150e7a36a9d339b5deb75bacae5a74000bd66260c710bfeff7cbc74a1f74e2d237fb07ad84e754657a7e5cf168f9d05c2f4c50c2188f29235ff6588c153ea327e267ab7499ed518d11c958b21f23e31b18010c14fdf56caf76144a38a6367e788d2171e4040c6ae40a39e4068104dce5452e226fb69a8de4cd011e6e55ead7a332868cf67f09a9fd7779e0e9cb6006f9f9f9c3000d8144f68814a46a8046dbf8b69d28c927edd2a35e4fa3b9e798b0d923984c846c6708f37a2ca6ecc962c5d0bbdcda17137e85b91789601edb335d14ac1e8a09ad000e9de8852f0fc1672c5d850c164ec1e4cb107456682fd061b7f89816da71fc476b630f02b56aa4af5b69a164c2f9f195958f306459aa27de88ca12f03445da2ecd000f2c48d8017e193210406d6a435fc3eb5281852ce1a8f0364cfb17c2794f36d6331e2c56c9bd2ebadbf4006a7bc8f73d388ea0ef0162daa50dfaa6fbd58c2906720110bf06d7fe50156ee8d8f37352331f5dd9a92fb323d084a81d8be5443de935d21c17a96cc94017db53952b9620891c05168f3a6f60a3c9926c03d79c6fd72f05d70011d0c7628c292ab2056dbd5685dfe694af8928dddd89fc1cfc8ec5491b0f0f9c712538b4b3bb8497f4c717cc7307da82796e871956fddd96584655a40dab4b005a01683c65e700000000001ae101faedac5851e32b9b23b5f9411a8c2bac4aae3ed4dd7b811dd1a72ea4aa7100000000081971ff014155575600000000000d26f33c00002710878a122cc0fae82c7cdc58ee2b477a57187419ad05005500bade5c63f281d36a13dbb64ed0ae1c532a434b6771b11885f396a41f56cc3bd00000000005f5e1000000000000000001fffffff800000000683c65e700000000683c65e60000000005f5e100000000000000000100005500f253cf87dc7d5ed5aa14cba5a6e79aee8bcfaef885a0e1b807035a0bbecc36fa0003b6a1f5573e680000025786d514fbfffffff600000000683c65e700000000683c65e60003b41966ae1a0000000274a584b680000055002817d7bfe5c64b8ea956e9a26f573ef64e72e4d7891f2d6af9bcc93f7aff9a97000009869f7bc54f00000004d0095d60fffffff800000000683c65e700000000683c65e60000097f01d1720000000004512cea840000550042bfb26778f3504a9f359a92c731f77d0c24aed9b7745276e3ad0c2d840b74c2000009818ecf47210000000587466bdafffffff800000000683c65e700000000683c65e600000980d39018e0000000065edde46000005500b04edaa5eba1fb048c18b727466681894f0ab21dd89643432af0277162dedb6d00000000000000000000000000000000fffffff8000000000000000000000000000000000000000000000000000000000000000000";
```




